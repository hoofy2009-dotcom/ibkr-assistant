# IBKR Trading Assistant - 双智能顾问系统

## 🎉 双剑合璧！

本插件提供**两个互补的**智能交易助手，满足不同的交易需求：

### 🏃 **"闪电侠" (V1 经典版)** - 快速日内交易专家
专注于分钟级别的快速决策，适合做T、日内波段操作。

### 🧠 **"智囊团" (V2 Pro版)** - 深度分析战略家  
整合多维度数据进行综合分析，适合中长期持仓决策。

**两者并行运行，互不干扰，您可以同时使用两个助手进行对比！**

---

## 🚀 功能对比

### 🏃 **闪电侠特色** (适合日内交易)
- ⚡ **10秒/20秒/30秒智能刷新** - 根据波动率自动调整
- 📊 **Watchlist历史追踪** - 14个价格点实时监控
- 🎯 **做T策略信号** - 基于ATR波动率的低吸高抛提醒
- 🔔 **即时声音通知** - 触发信号立即提醒(800Hz/600Hz)
- 📈 **技术指标趋势箭头** - 一目了然的方向判断(↗️↘️➡️)

### 🧠 **智囊团特色** (适合深度分析)
- 📰 **Finnhub实时新闻** - 比Yahoo RSS更快更专业
- 😊 **AI情绪分析** - 批量分析新闻正负面倾向
- 📅 **财报倒计时** - 🔥今日财报/⚠️3天内预警
- 🏢 **同行业对比** - P/E, ROE vs 行业均值
- 📈 **历史财报表现** - 过去4季度EPS惊喜率
- 📝 **交易日志系统** - 记录决策过程和业绩统计

---

## 🎯 使用场景指南

| 交易类型 | 推荐助手 | 原因 |
|---------|---------|------|
| **日内做T** | 🏃 闪电侠 | 秒级刷新 + 波动率信号 + 即时通知 |
| **短线波段** | 🏃 闪电侠 | Watchlist追踪 + 技术指标趋势 |
| **持仓决策** | 🧠 智囊团 | 新闻情绪 + 财报分析 + AI综合建议 |
| **财报前后** | 🧠 智囊团 | 财报倒计时 + 历史表现 + 风险评估 |
| **行业研究** | 🧠 智囊团 | 同行业对比 + 深度数据分析 |
| **快速止损** | 🏃 闪电侠 | 实时价格 + ATR动态止损 + 声音警报 |

**💡 Pro技巧**: 
- 开盘前用**智囊团**制定策略 → 开盘后用**闪电侠**执行操作
- 长期持仓用**智囊团**监控 → 日内调仓用**闪电侠**捕捉时机

---

## 🚀 智囊团新功能 (V2)

### **P0 - 已实现核心功能**

#### 1. **📊 技术指标分析**
- **RSI(14)** - 相对强弱指标，自动标注超买/超卖
- **MACD** - 移动平均收敛发散指标，显示金叉/死叉信号
- **ATR(14)** - 平均真实波幅，用于波动率分析
- **动态止损** - 基于 ATR 自动计算止损位（价格 - 2×ATR）

#### 2. **📰 实时新闻 (Finnhub API)**
- 最近 7 天的公司新闻
- 显示新闻标题、来源、日期
- 比 Yahoo RSS 更及时和专业

#### 3. **📅 财报日历 (Finnhub API)**
- 显示下次财报日期
- EPS 预期值
- 营收预期值

#### 4. **🤖 AI 深度分析**
- 整合技术指标 + 新闻 + 财报进行综合分析
- 明确给出 BUY/SELL/HOLD 建议
- 提供止损位和目标价
- 风险评分（1-10）
- 可一键记录到交易日志

#### 5. **📝 交易日志 & 业绩追踪**
- 记录每笔交易的进场价、建议、理由
- 自动追踪技术指标快照（RSI、MACD）
- 统计总交易数、胜率、总盈亏
- 支持导出和回顾

---

## 📖 使用指南

### **步骤 1: 获取免费 API Keys**

#### **Finnhub (推荐)** 
1. 访问 [Finnhub.io](https://finnhub.io)
2. 注册免费账户
3. 获取 API Key（免费 tier：60 calls/分钟）
4. 在 V2 设置中填入

#### **NewsAPI (可选备用)**
1. 访问 [NewsAPI.org](https://newsapi.org)
2. 注册免费账户
3. 获取 API Key（免费 tier：100 calls/天）

### **步骤 2: 配置智囊团**
1. 打开 IBKR Portal 交易页面
2. 页面右侧会同时出现两个面板：
   - **🏃 闪电侠**: 左侧面板（或顶部）- 专注快速交易
   - **🧠 智囊团**: 右侧面板（或下方）- 提供深度分析
3. 点击智囊团面板底部的 **"⚙️ 设置"**
4. 填入 Finnhub API Key
5. 点击 **"保存"**

### **步骤 3: 开始使用**
1. **查看技术指标** - 自动计算并显示 RSI、MACD、ATR
2. **阅读新闻** - 滚动查看最新公司新闻
3. **检查财报** - 查看即将到来的财报日期
4. **点击"开始分析"** - AI 会整合所有数据给出建议
5. **记录交易** - 如果决定操作，点击"记录到交易日志"

---

## 🎯 详细功能对比表

| 功能 | 🏃 闪电侠 | 🧠 智囊团 | 说明 |
|------|----------|----------|------|
| **刷新频率** | ⚡ 10-30秒智能调整 | 📊 手动刷新 | 闪电侠根据波动率自动加速 |
| **价格监控** | ✅ 实时盘前盘后 | ✅ 实时盘前盘后 | 两者都支持全时段监控 |
| **宏观指标** | ✅ (SPY, VIX) | ✅ | 市场大盘和恐慌指数 |
| **技术指标** | ✅ (RSI, MACD, ATR) | ✅ (RSI, MACD, ATR) | 相同的技术分析工具 |
| **动态止损** | ✅ (基于 ATR) | ✅ (基于 ATR) | 智能止损位计算 |
| **做T策略信号** | ✅ 日内波动+ATR | ❌ | 🏃专属:低吸高抛时机提醒 |
| **Watchlist监控** | ✅ 14点历史+波动率 | ❌ | 🏃专属:多股票实时追踪 |
| **声音通知** | ✅ 双音调提醒 | ❌ | 🏃专属:触发信号立即响 |
| **趋势箭头** | ✅ (↗️↘️➡️) | ❌ | 🏃专属:指标方向可视化 |
| **实时新闻** | ⚠️ (Yahoo RSS 延迟) | ✅ (Finnhub 实时) | 🧠胜出:更快更准 |
| **新闻翻译** | ❌ | ✅ | 🧠专属:中文翻译 |
| **情绪分析** | ❌ | ✅ (AI批量分析) | 🧠专属:😊😐😢自动标注 |
| **财报日历** | ❌ | ✅ (倒计时+预期) | 🧠专属:🔥今日/⚠️3天预警 |
| **同行业对比** | ❌ | ✅ (P/E, ROE) | 🧠专属:vs行业均值 |
| **历史财报** | ❌ | ✅ (4季度EPS) | 🧠专属:惊喜率分析 |
| **AI综合分析** | ✅ (多模型) | ✅ (深度整合) | 智囊团整合更多维度 |
| **交易日志** | ❌ | ✅ | 🧠专属:记录决策过程 |
| **业绩统计** | ❌ | ✅ (胜率、盈亏) | 🧠专属:量化交易表现 |

**🎯 核心差异**:
- **闪电侠** = 速度 + 即时性 + 执行力 (适合盯盘交易)
- **智囊团** = 深度 + 多维度 + 决策力 (适合研究分析)

---

## 📊 技术指标说明

### **RSI (相对强弱指标)**
- **范围**: 0-100
- **超卖**: < 30 → 可能反弹机会
- **超买**: > 70 → 可能回调风险
- **中性**: 30-70

### **MACD (指数平滑移动平均线)**
- **金叉**: MACD 从负转正 → 看涨信号
- **死叉**: MACD 从正转负 → 看跌信号
- **柱状图**: 正值=多头，负值=空头

### **ATR (平均真实波幅)**
- 衡量价格波动性
- 数值越大 = 波动越剧烈
- 用于动态调整止损距离

### **动态止损**
- 公式: 当前价 - (ATR × 2)
- 优势: 根据波动性自适应调整
- 避免被正常波动扫损

---

## 💾 数据存储

两个助手的数据**完全隔离**，互不影响：

### 🏃 闪电侠存储:
- **Watchlist**: `assist_watchlist`
- **历史数据**: `assist_history_cache`
- **设置**: `assist_settings`

### 🧠 智囊团存储:
- **设置**: `assist_v2_settings`
- **API Keys**: `assist_v2_keys`
- **交易日志**: `assist_v2_trades`

所有数据保存在 Chrome 本地存储，**不会上传到任何服务器**！

---

## 🔮 未来计划 (P1-P3)

### **P1 - 短期 (1-2周)**
- [ ] 回测引擎 - 用历史数据验证策略
- [ ] 财报惊喜分析 - EPS actual vs estimate
- [ ] 更多技术指标 (Bollinger Bands, Stochastic)

### **P2 - 中期 (1个月)**
- [ ] TradingView 图表嵌入
- [ ] 云端同步 (Firebase)
- [ ] 导出交易日志为 CSV

### **P3 - 长期 (未来)**
- [ ] 真正 API 交易 (Alpaca/IBKR)
- [ ] 多因子量化模型
- [ ] 移动端 App

---

## ❓ 常见问题

**Q: 智囊团会替代闪电侠吗？**  
A: 不会！两者定位不同。闪电侠专注快速执行，智囊团专注深度分析，**建议同时使用**！

**Q: 我可以只使用其中一个吗？**  
A: 当然可以！如果你只做日内交易，闪电侠就够了；如果你只做中长期投资，智囊团更适合。

**Q: 两个助手会冲突吗？**  
A: 不会！它们的数据和逻辑完全隔离，可以安全地同时运行。

**Q: Finnhub 免费 tier 够用吗？**  
A: 完全够用！60 calls/min 对个人交易绰绰有余。

**Q: 闪电侠的通知太吵怎么办？**  
A: 可以在浏览器设置中调整音量，或者修改代码中的声音频率。

**Q: 交易日志保存在哪里？**  
A: Chrome 本地存储，不会上传到服务器。建议定期导出备份。

**Q: 如何卸载某个助手？**  
A: 在 manifest.json 中移除对应的 js/css 文件即可。

---

## 📞 支持

如有问题或建议，请在 GitHub Issues 中反馈！

**Repository**: [github.com/hoofy2009-dotcom/ibkr-assistant](https://github.com/hoofy2009-dotcom/ibkr-assistant)

---

**Happy Trading with 🏃闪电侠 & 🧠智囊团! 📈💰**
