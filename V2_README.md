# IBKR Trading Assistant V2 - 智能顾问 2.0

## 🎉 全新升级！

智能顾问 V2 是一个**独立的**高级交易分析工具，与 V1 并行运行，互不干扰。您可以同时使用两个版本进行对比。

---

## 🚀 V2 新功能

### **P0 - 已实现核心功能**

#### 1. **📊 技术指标分析**
- **RSI(14)** - 相对强弱指标，自动标注超买/超卖
- **MACD** - 移动平均收敛发散指标，显示金叉/死叉信号
- **ATR(14)** - 平均真实波幅，用于波动率分析
- **动态止损** - 基于 ATR 自动计算止损位（价格 - 2×ATR）

#### 2. **📰 实时新闻 (Finnhub API)**
- 最近 7 天的公司新闻
- 显示新闻标题、来源、日期
- 比 Yahoo RSS 更及时和专业

#### 3. **📅 财报日历 (Finnhub API)**
- 显示下次财报日期
- EPS 预期值
- 营收预期值

#### 4. **🤖 AI 深度分析**
- 整合技术指标 + 新闻 + 财报进行综合分析
- 明确给出 BUY/SELL/HOLD 建议
- 提供止损位和目标价
- 风险评分（1-10）
- 可一键记录到交易日志

#### 5. **📝 交易日志 & 业绩追踪**
- 记录每笔交易的进场价、建议、理由
- 自动追踪技术指标快照（RSI、MACD）
- 统计总交易数、胜率、总盈亏
- 支持导出和回顾

---

## 📖 使用指南

### **步骤 1: 获取免费 API Keys**

#### **Finnhub (推荐)** 
1. 访问 [Finnhub.io](https://finnhub.io)
2. 注册免费账户
3. 获取 API Key（免费 tier：60 calls/分钟）
4. 在 V2 设置中填入

#### **NewsAPI (可选备用)**
1. 访问 [NewsAPI.org](https://newsapi.org)
2. 注册免费账户
3. 获取 API Key（免费 tier：100 calls/天）

### **步骤 2: 配置 V2**
1. 打开 IBKR Portal 交易页面
2. 页面右侧会同时出现两个面板：
   - **左侧（或顶部）**: 智能顾问 V1（原版）
   - **右侧（或下方）**: 智能顾问 V2（Pro）
3. 点击 V2 面板底部的 **"⚙️ V2 设置"**
4. 填入 Finnhub API Key
5. 点击 **"保存"**

### **步骤 3: 开始使用**
1. **查看技术指标** - 自动计算并显示 RSI、MACD、ATR
2. **阅读新闻** - 滚动查看最新公司新闻
3. **检查财报** - 查看即将到来的财报日期
4. **点击"开始分析"** - AI 会整合所有数据给出建议
5. **记录交易** - 如果决定操作，点击"记录到交易日志"

---

## 🎯 V2 vs V1 对比

| 功能 | V1 (经典版) | V2 (Pro版) |
|------|------------|-----------|
| **基础价格监控** | ✅ | ✅ |
| **宏观指标** | ✅ (SPY, VIX) | ✅ |
| **AI 分析** | ✅ (多模型) | ✅ (深度整合) |
| **技术指标** | ✅ (RSI, MACD, ATR) | ✅ (RSI, MACD, ATR) |
| **动态止损** | ✅ (基于 ATR) | ✅ (基于 ATR) |
| **做T策略** | ✅ (日内波动+ATR) | ❌ |
| **Watchlist做T信号** | ✅ (涨跌+波动率) | ❌ |
| **实时新闻** | ⚠️ (Yahoo RSS 延迟) | ✅ (Finnhub 实时+翻译) |
| **财报日历** | ❌ | ✅ |
| **交易日志** | ❌ | ✅ |
| **业绩统计** | ❌ | ✅ (胜率、盈亏) |

---

## 📊 技术指标说明

### **RSI (相对强弱指标)**
- **范围**: 0-100
- **超卖**: < 30 → 可能反弹机会
- **超买**: > 70 → 可能回调风险
- **中性**: 30-70

### **MACD (指数平滑移动平均线)**
- **金叉**: MACD 从负转正 → 看涨信号
- **死叉**: MACD 从正转负 → 看跌信号
- **柱状图**: 正值=多头，负值=空头

### **ATR (平均真实波幅)**
- 衡量价格波动性
- 数值越大 = 波动越剧烈
- 用于动态调整止损距离

### **动态止损**
- 公式: 当前价 - (ATR × 2)
- 优势: 根据波动性自适应调整
- 避免被正常波动扫损

---

## 💾 数据存储

所有 V2 数据存储在 Chrome 本地 storage 中：
- **设置**: `assist_v2_settings`
- **API Keys**: `assist_v2_keys`
- **交易日志**: `assist_v2_trades`

**与 V1 完全隔离**，互不影响！

---

## 🔮 未来计划 (P1-P3)

### **P1 - 短期 (1-2周)**
- [ ] 回测引擎 - 用历史数据验证策略
- [ ] 财报惊喜分析 - EPS actual vs estimate
- [ ] 更多技术指标 (Bollinger Bands, Stochastic)

### **P2 - 中期 (1个月)**
- [ ] TradingView 图表嵌入
- [ ] 云端同步 (Firebase)
- [ ] 导出交易日志为 CSV

### **P3 - 长期 (未来)**
- [ ] 真正 API 交易 (Alpaca/IBKR)
- [ ] 多因子量化模型
- [ ] 移动端 App

---

## ❓ 常见问题

**Q: V2 会替代 V1 吗？**  
A: 不会！V2 是独立工具，两者可以并存使用。

**Q: Finnhub 免费 tier 够用吗？**  
A: 完全够用！60 calls/min 对个人交易绰绰有余。

**Q: 技术指标需要多少数据？**  
A: 至少 14 个价格点（约 14 秒），自动积累。

**Q: 交易日志保存在哪里？**  
A: Chrome 本地存储，不会上传到服务器。

**Q: 如何卸载 V2？**  
A: 在 manifest.json 中移除 `advisor-v2.js` 和 `styles-v2.css` 即可。

---

## 📞 支持

如有问题或建议，请在 GitHub Issues 中反馈！

**Repository**: [github.com/hoofy2009-dotcom/ibkr-assistant](https://github.com/hoofy2009-dotcom/ibkr-assistant)

---

**Happy Trading! 📈💰**
